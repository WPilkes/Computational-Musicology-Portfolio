---
title: "Concentrating or Relaxing: How My Activities Influence My Jazz Habits"
output: 
  flexdashboard::flex_dashboard:
    
    storyboard: true
    css: style.css
    theme: journal
  html_document: 
    keep_md: true 
---

```{r}

```

```{r}

library(compmus)
library(tidyverse)
library(spotifyr)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(flexdashboard)
```

```{r, echo=FALSE}
genjazz <- get_playlist_audio_features("", "5vXOWi2SAMHjQUv2p77wok")
elejazz <- get_playlist_audio_features("", "2F2bLwuWwWWNwWb0VtZ0Ig")
orijazz <- get_playlist_audio_features("", "5m1ElO7AZ7y1qsdKHUqNQv")

jazz_gen_ele<- rbind(genjazz, elejazz)
jazz_ele_ori <- rbind(elejazz, orijazz)
jazz_full <- rbind(genjazz, elejazz, orijazz)
```



### [NEW!!!] Outliers within the corpus: confusing relations between the Tempo of different Songs

```{r}

graph_intro <- ggplot(jazz_ele_ori, aes(x=playlist_name, y = tempo, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank()) 

track_ele <- get_tidy_audio_analysis("2gLX4rTL0C619j1oLJxNXp") %>%
  select(segments) %>%
  unnest(segments)

graph_ele <- track_ele %>%
  mutate(pitches = map(pitches, compmus_normalise, "clr")) %>%
  arrange(start) %>%
  mutate(pitches = map2(pitches, lag(pitches), `-`)) %>%
  slice(-1) %>%
  compmus_gather_chroma() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = pmax(0, value)
    )
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  xlim(0, 100) +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude",  title="[A] I wanna Be Around - Beegie Adair | 215.908 BPM" )  +
  theme_classic() + theme( plot.title = element_text(size=6) )


track_ori <-
  get_tidy_audio_analysis("1smChL3Aq1U9DZA83LuDtp") %>%
  select(segments) %>%
  unnest(segments)

graph_ori <- track_ori %>%
  mutate(pitches = map(pitches, compmus_normalise, "clr")) %>%
  arrange(start) %>%
  mutate(pitches = map2(pitches, lag(pitches), `-`)) %>%
  slice(-1) %>%
  compmus_gather_chroma() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = pmax(0, value)
    )
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  xlim(0, 100) +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="[B] I wanna Be Around - Tony Bennet | 69.601 BPM") +
  theme_classic()+ theme( plot.title = element_text(size=6) )


track_avg <-
  get_tidy_audio_analysis("4BBoGx5zuFC07A8wx2V0cs") %>%
  select(segments) %>%
  unnest(segments)

graph_avg <- track_avg %>%
  mutate(pitches = map(pitches, compmus_normalise, "clr")) %>%
  arrange(start) %>%
  mutate(pitches = map2(pitches, lag(pitches), `-`)) %>%
  slice(-1) %>%
  compmus_gather_chroma() %>%
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = pmax(0, value)
    )
  ) +
  geom_tile() +
  scale_fill_viridis_c(guide = "none") +
  xlim(0, 100) +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title="[C] You Are the Sunshine of My Life - New york Bar Quartett | 109.921 BPM") +
  theme_classic()+ theme( plot.title = element_text(size=6) )

```


```{r}
grid.arrange(graph_intro, graph_avg, graph_ele, graph_ori, ncol=2)
```

***

Lets have a look at the outlier present in the "Elevator Jazz" list. We can see a boxplot of the differences in tempo for the "elevator jazz" list and the list of the original songs of that list (upper left). As you can see they have a mostly similar distribution. But the "Elevator Jazz" list has one outlier: "I wanna Be Around - Beegie Adair" at an average tempo of 215.908 BPM. This seems very interesting. Thus it is time to compare this song with its original "I wanna Be Around - Tony Bennet", and a song in the playlist with an average tempo: "You Are the Sunshine of My Life - New york Bar Quartett".

After listening to these three songs it is apparent that both song [B] and [C] actually have a higher tempo than song [A]. Actually, song [A] seems to be one of the more slower songs in the corpus, yet spotify has decided it has a high BPM. The chordograms also do not show any irregularities.



### My Jazz Habits: Different playlist for different moods

<br/><br/>

My general jazz: <br/>
https://open.spotify.com/playlist/5vXOWi2SAMHjQUv2p77wok?si=UOyfD71rQ4m_tJ3yhPypLA <br/>

My elevator jazz: <br/>
https://open.spotify.com/playlist/2F2bLwuWwWWNwWb0VtZ0Ig?si=QP4-U6HNR4ax-mHIvLyA5w <br/>

Original tracks of the elevator jazz list: <br/>
https://open.spotify.com/playlist/5m1ElO7AZ7y1qsdKHUqNQv?si=aQeg35uYQ-aC_-xFhUyG8A <br/>

<br/><br/>

(Give a visual impression of what the playlists consist of, put some album covers or pictures of artist here. Do something with the hyperlinks of the playlists.)





***

When I am studying or just relaxing I often listen to Jazz. It can set a mood and is often good background music whilst focussing on other things. I have got two main spotify jazz lists I listen to.
One of the lists is an arbitrary mix of different Jazz songs I enjoy. The songs are from different sub-genres and were composed at different times. 
The other jazz list consists of more "toned-down" versions of popular jazz songs. There are no vocals and abrupt changes in the song feel less intense. I call this my "elevator music"-jazz list.

There is a slight overlap between the two lists. For example, the classic jazz song "Take five - The Dave Bruback Quartet" is part of general jazz list, whilst a different version "Take 5 - New York Jazz Lounge" is part of the elevator jazz list. These songs are extremely similar, yet sometimes I want to listen to the normal jazz list and sometimes to the elevator jazz list.


Given that the elevator jazz list consists of simplified versions of popular jazz songs, it would be interesting to find out how they differ. Thus I have created a version of this list with the original tracks. These list will also be compared. 

<b/r>

All this leads into multiple interesting things that can be researched:

- How do these list differ from each other and why?

- Can this explain my decisions in when to listen to which playlist?

- What similarities can be found throughout the whole corpus?

- How do the elevator jazz songs differ from the originals?



### Comparing the elevator jazz with the general jazz list.

```{r, echo=FALSE}

p1 <- ggplot(jazz_gen_ele, aes(x=playlist_name, y = energy, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank())


p2 <- ggplot(jazz_gen_ele, aes(x=playlist_name, y =acousticness, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank())


p3 <- ggplot(jazz_gen_ele, aes(x=playlist_name, y = speechiness, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank())+ 
  scale_y_log10()
  
p4 <-ggplot(jazz_gen_ele, aes(x=playlist_name, y = danceability, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank())

grid.arrange(p1, p2, p3, p4, ncol=2)

```

***


After exploring the two lists, some notable differences and similarities were found. First of all, as predicted, the elevator jazz list has lower energy and a higher acousticness.

Secondly, it was found that the elevator jazz list has a lower speechiness. This is expected, because the list was designed to not contain any vocals. To the contrary the elevator jazz list has a higher danceability, this is unexpected because the list is mainly listened to when I am studying. This is also interesting because this list has a lower overal energy, yet a higher danceability. 


### Comparing the elevator jazz with its original songs. 

```{r, echo=FALSE}

p1 <- ggplot(jazz_ele_ori, aes(x=playlist_name, y = energy, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank())


p2 <- ggplot(jazz_ele_ori, aes(x=playlist_name, y =acousticness, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank())


p3 <- ggplot(jazz_ele_ori, aes(x=playlist_name, y = speechiness, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank())+ 
  scale_y_log10()
  
p4 <-ggplot(jazz_ele_ori, aes(x=playlist_name, y = danceability, fill = playlist_name)) +
  geom_boxplot() + 
  theme(legend.position = "none", axis.title.x = element_blank())

grid.arrange(p1, p2, p3, p4, ncol=2)

```


***



### Different Timbre Coefficients between the Elevator Jazz and its Original List
```{r}
bebop <-
  get_playlist_audio_features(
    "",
    "2F2bLwuWwWWNwWb0VtZ0Ig"
  ) %>%
  slice(1:30) %>%
  add_audio_analysis()
bigband <-
  get_playlist_audio_features(
    "",
    "5m1ElO7AZ7y1qsdKHUqNQv"
  ) %>%
  slice(1:30) %>%
  add_audio_analysis()
jazz3 <-
  bebop %>%
  mutate(genre = "Elevator Jazz") %>%
    bind_rows(bigband %>% mutate(genre = "Elevator Jazz (Originals)"))

jazz3 %>%
  mutate(
    timbre =
      map(
        segments,
        compmus_summarise,
        timbre,
        method = "mean"
      )
  ) %>%
  select(genre, timbre) %>%
  compmus_gather_timbre() %>%
  ggplot(aes(x = basis, y = value, fill = genre)) +
  geom_violin() +
  scale_fill_viridis_d() +
  labs(x = "Spotify Jazz lists Timbre Coefficients", y = "", fill = "Playlist")
```

***

Here you can see a summary of the different timbre coefficients between "Elevator Jazz" and "Elevator Jazz (Originals). 



### Further Evaluation

```{r, echo=FALSE}

ggplot(jazz_full, aes(x=energy, y=acousticness, color=playlist_name)) +
  geom_point(alpha=.6) 

```


***


### Conclusion
